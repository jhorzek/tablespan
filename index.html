<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create Satisficing Excel, HTML, LaTeX, and RTF Tables using a Simple Formula • tablespan</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Create Satisficing Excel, HTML, LaTeX, and RTF Tables using a Simple Formula">
<meta name="description" content='Create "good enough" tables with a single formula. tablespan tables can be exported to Excel, HTML, LaTeX, and RTF by leveraging the packages openxlsx and gt. See &lt;https://jhorzek.github.io/tablespan/&gt; for an introduction.'>
<meta property="og:description" content='Create "good enough" tables with a single formula. tablespan tables can be exported to Excel, HTML, LaTeX, and RTF by leveraging the packages openxlsx and gt. See &lt;https://jhorzek.github.io/tablespan/&gt; for an introduction.'>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tablespan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jhorzek/tablespan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tablespan">tablespan<a class="anchor" aria-label="anchor" href="#tablespan"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<blockquote>
<p>Create satisficing tables in R the formula way.</p>
</blockquote>
<p>The core objective of <code>tablespan</code> is to:</p>
<ol style="list-style-type: decimal">
<li>provide a “good enough” approach to easily create tables by leveraging R’s formulas.</li>
<li>provide direct exports to other, more flexible table packages such as <code>gt</code>, <code>flextable</code>, and <code>huxtable</code>.</li>
</ol>
<p>The following shows an example, where we define a relatively complex table header setup with a single formula. The details of the syntax will be explained below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jhorzek/tablespan" class="external-link">tablespan</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summarized_table</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">vs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            mean_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            sd_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            mean_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span>,</span>
<span>            sd_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'cyl'. You can override using the `.groups`</span></span>
<span><span class="co">#&gt; argument.</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>                 formula <span class="op">=</span> <span class="va">Cylinder</span><span class="op">:</span><span class="va">cyl</span> <span class="op">+</span> <span class="va">Engine</span><span class="op">:</span><span class="va">vs</span> <span class="op">~</span></span>
<span>                   <span class="va">N</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="va">`Horse Power`</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_hp</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_hp</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="va">`Weight`</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_wt</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_wt</span><span class="op">)</span>,</span>
<span>                 title <span class="op">=</span> <span class="st">"Motor Trend Car Road Tests"</span>,</span>
<span>                 subtitle <span class="op">=</span> <span class="st">"A table created with tablespan"</span>,</span>
<span>                 footnote <span class="op">=</span> <span class="st">"Data from the infamous mtcars data set."</span><span class="op">)</span></span>
<span><span class="va">tbl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>use_hux <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Motor Trend Car Road Tests</span></span>
<span><span class="co">#&gt; A table created with tablespan</span></span>
<span><span class="co">#&gt;                                                         </span></span>
<span><span class="co">#&gt;  |                 |     Horse Power       Weight      |</span></span>
<span><span class="co">#&gt;  | Cylinder Engine | N   Mean        SD    Mean   SD   |</span></span>
<span><span class="co">#&gt;  | -------- ------ - --  ----------- ----- ------ ---- |</span></span>
<span><span class="co">#&gt;  | 4        0      | 1   91                2.14        |</span></span>
<span><span class="co">#&gt;  | 4        1      | 10  81.8        21.87 2.3    0.6  |</span></span>
<span><span class="co">#&gt;  | 6        0      | 3   131.67      37.53 2.76   0.13 |</span></span>
<span><span class="co">#&gt;  | ...      ...    | ... ...         ...   ...    ...  |</span></span>
<span><span class="co">#&gt; Data from the infamous mtcars data set.</span></span></code></pre></div>
<p>This basic table can now be easily exported to other table formats.</p>
</div>
<div class="section level1">
<h1 id="r-packages-for-table-conversion-and-export">R Packages for Table Conversion and Export<a class="anchor" aria-label="anchor" href="#r-packages-for-table-conversion-and-export"></a>
</h1>
<p><code>tablespan</code> builds on the awesome packages <a href="https://gt.rstudio.com/" class="external-link"><code>gt</code></a>, <a href="https://ycphs.github.io/openxlsx/" class="external-link"><code>openxlsx</code></a> , <a href="https://ardata-fr.github.io/flextable-book/index.html" class="external-link"><code>flextable</code></a>, and <a href="https://hughjonesd.github.io/huxtable/index.html" class="external-link"><code>huxtable</code></a>. This allows <code>tablespan</code> tables to be exported to a large number of formats:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Package</th>
<th>Conversion Function</th>
<th>Description</th>
<th>Export Formats</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>gt</strong></td>
<td><code><a href="reference/as_gt.html">as_gt()</a></code></td>
<td>The <strong>gt</strong> package (Great Tables) provides a grammar for creating publication-ready tables with fine-grained control over styling, formatting, and layout.</td>
<td>HTML, PDF, PNG, LaTeX, RTF, Word (<a href="https://gt.rstudio.com/reference/gtsave.html" class="external-link">docs</a>)</td>
</tr>
<tr class="even">
<td><strong>openxlsx</strong></td>
<td><code><a href="reference/as_excel.html">as_excel()</a></code></td>
<td>The <strong>openxlsx</strong> package offers Excel file creation and manipulation. Great for reporting tables to end-users.</td>
<td>Excel (<a href="https://ycphs.github.io/openxlsx/index.html" class="external-link">docs</a>)</td>
</tr>
<tr class="odd">
<td><strong>flextable</strong></td>
<td><code>as_flextable()</code></td>
<td>
<strong>flextable</strong> specializes in creating complex, publication-quality tables with extensive formatting capabilities. Integrates well with Word/PowerPoint workflows.</td>
<td>HTML, Word, RTF, PowerPoint, PDF, PNG (<a href="https://ardata-fr.github.io/flextable-book/rendering.html" class="external-link">docs</a>)</td>
</tr>
<tr class="even">
<td><strong>huxtable</strong></td>
<td><code>as_huxtable()</code></td>
<td>
<strong>huxtable</strong> provides a unified interface for creating tables in multiple output formats. Also provides styled printing to the console.</td>
<td>LaTeX, Typst, HTML, Word, Excel, RTF, markdown, console (<a href="https://hughjonesd.github.io/huxtable/reference/index.html" class="external-link">docs</a>)</td>
</tr>
</tbody>
</table>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install <code>tablespan</code> from CRAN use:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tablespan"</span><span class="op">)</span></span></code></pre></div>
<p>The development version of <code>tablespan</code> can be installed from GitHub with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"jhorzek/tablespan"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>R has a large set of great packages that allow you to create and export tables that look exactly like you envisioned. However, sometimes you may just need a good-enough table that is easy to create and share with others. This is where <code>tablespan</code> can be of help.</p>
<p>Let’s assume that we want to share the following table:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summarized_table</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">vs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            mean_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            sd_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            mean_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span>,</span>
<span>            sd_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'cyl'. You can override using the `.groups`</span></span>
<span><span class="co">#&gt; argument.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summarized_table</span>, use_hux <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 7</span></span>
<span><span class="co">#&gt; # Groups:   cyl [3]</span></span>
<span><span class="co">#&gt;     cyl    vs     N mean_hp sd_hp mean_wt  sd_wt</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     4     0     1    91   NA       2.14 NA    </span></span>
<span><span class="co">#&gt; 2     4     1    10    81.8 21.9     2.30  0.598</span></span>
<span><span class="co">#&gt; 3     6     0     3   132.  37.5     2.76  0.128</span></span>
<span><span class="co">#&gt; 4     6     1     4   115.   9.18    3.39  0.116</span></span>
<span><span class="co">#&gt; 5     8     0    14   209.  51.0     4.00  0.759</span></span></code></pre></div>
<p>We don’t want to share the table as is - the variable names are all a bit technical and the table could need some spanners summarizing columns. So, we want to share a table that looks something like this:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">|</span>                   <span class="er">|</span> Horse Power <span class="sc">|</span>   Weight  <span class="sc">|</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="er">|</span> Cylinder <span class="sc">|</span> Engine <span class="sc">|</span> Mean  <span class="sc">|</span>  SD <span class="sc">|</span> Mean <span class="sc">|</span> SD <span class="sc">|</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="er">|</span> <span class="sc">--------</span> <span class="er">|</span> <span class="sc">------</span> <span class="er">|</span> <span class="sc">-----</span> <span class="er">|</span> <span class="sc">---</span> <span class="er">|</span> <span class="sc">----</span> <span class="er">|</span> <span class="sc">--</span> <span class="er">|</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="er">|</span>                   <span class="er">|</span>                         <span class="er">|</span></span></code></pre></div>
<p><code>tablespan</code> allows us to create this table with a single formula.</p>
<div class="section level3">
<h3 id="creating-a-basic-table">Creating a Basic Table<a class="anchor" aria-label="anchor" href="#creating-a-basic-table"></a>
</h3>
<p>In <code>tablespan</code>, the table headers are defined with a formula. For example, <code>cyl ~ mean_hp + sd_hp</code> defines a table with <code>cyl</code> as the row names and <code>mean_hp</code> and <code>sd_hp</code> as columns:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jhorzek/tablespan" class="external-link">tablespan</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="va">cyl</span> <span class="op">~</span> <span class="va">mean_hp</span> <span class="op">+</span> <span class="va">sd_hp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>use_hux <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         </span></span>
<span><span class="co">#&gt;  | cyl | mean_hp sd_hp |</span></span>
<span><span class="co">#&gt;  | --- - ------- ----- |</span></span>
<span><span class="co">#&gt;  | 4   | 91            |</span></span>
<span><span class="co">#&gt;  | 4   | 81.8    21.87 |</span></span>
<span><span class="co">#&gt;  | 6   | 131.67  37.53 |</span></span>
<span><span class="co">#&gt;  | ... | ...     ...   |</span></span></code></pre></div>
<p>Note that the row names (<code>cyl</code>) are in a separate block to the left.</p>
</div>
<div class="section level3">
<h3 id="adding-spanners">Adding Spanners<a class="anchor" aria-label="anchor" href="#adding-spanners"></a>
</h3>
<p>Spanners are defined using braces and spanner names. For example, the following defines a spanner for <code>mean_hp</code> and <code>sd_hp</code> with the name <code>Horsepower</code>: <code>cyl ~ (Horsepower = mean_hp + sd_hp)</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="va">cyl</span> <span class="op">~</span> <span class="op">(</span><span class="va">Horsepower</span> <span class="op">=</span> <span class="va">mean_hp</span> <span class="op">+</span> <span class="va">sd_hp</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>use_hux <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt;  |     | Horsepower       |</span></span>
<span><span class="co">#&gt;  | cyl | mean_hp    sd_hp |</span></span>
<span><span class="co">#&gt;  | --- - ---------- ----- |</span></span>
<span><span class="co">#&gt;  | 4   | 91               |</span></span>
<span><span class="co">#&gt;  | 4   | 81.8       21.87 |</span></span>
<span><span class="co">#&gt;  | 6   | 131.67     37.53 |</span></span>
<span><span class="co">#&gt;  | ... | ...        ...   |</span></span></code></pre></div>
<p>Spanners can also be nested:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="va">cyl</span> <span class="op">~</span> <span class="op">(</span><span class="va">Horsepower</span> <span class="op">=</span> <span class="op">(</span><span class="va">Mean</span> <span class="op">=</span> <span class="va">mean_hp</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">SD</span>  <span class="op">=</span> <span class="va">sd_hp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>use_hux <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt;  |     | Horsepower       |</span></span>
<span><span class="co">#&gt;  |     | Mean       SD    |</span></span>
<span><span class="co">#&gt;  | cyl | mean_hp    sd_hp |</span></span>
<span><span class="co">#&gt;  | --- - ---------- ----- |</span></span>
<span><span class="co">#&gt;  | 4   | 91               |</span></span>
<span><span class="co">#&gt;  | 4   | 81.8       21.87 |</span></span>
<span><span class="co">#&gt;  | 6   | 131.67     37.53 |</span></span>
<span><span class="co">#&gt;  | ... | ...        ...   |</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="renaming-columns">Renaming Columns<a class="anchor" aria-label="anchor" href="#renaming-columns"></a>
</h3>
<p>Variable names in an R <code>data.frame</code> are often very technical (e.g., <code>mean_hp</code> and <code>sd_hp</code>). When sharing the table, we may want to replace those names. In the example above, we may want to replace <code>mean_hp</code> and <code>sd_hp</code> with “Mean” and “SD”. In <code>tablespan</code> renaming variables is achieved with <code>new_name:old_name</code>. For example, <code>cyl ~ (Horsepower = Mean:mean_hp + SD:sd_hp)</code> renames <code>mean_hp</code> to <code>Mean</code> and <code>sd_hp</code> to <code>SD</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="va">cyl</span> <span class="op">~</span> <span class="op">(</span><span class="va">Horsepower</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_hp</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_hp</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>use_hux <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt;  |     | Horsepower       |</span></span>
<span><span class="co">#&gt;  | cyl | Mean       SD    |</span></span>
<span><span class="co">#&gt;  | --- - ---------- ----- |</span></span>
<span><span class="co">#&gt;  | 4   | 91               |</span></span>
<span><span class="co">#&gt;  | 4   | 81.8       21.87 |</span></span>
<span><span class="co">#&gt;  | 6   | 131.67     37.53 |</span></span>
<span><span class="co">#&gt;  | ... | ...        ...   |</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-the-full-table">Creating the Full Table<a class="anchor" aria-label="anchor" href="#creating-the-full-table"></a>
</h3>
<p>The combination of row names, spanners, and renaming of variables allows creating the full table:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jhorzek/tablespan" class="external-link">tablespan</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summarized_table</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">vs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            mean_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            sd_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            mean_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span>,</span>
<span>            sd_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'cyl'. You can override using the `.groups`</span></span>
<span><span class="co">#&gt; argument.</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>                 formula <span class="op">=</span> <span class="va">Cylinder</span><span class="op">:</span><span class="va">cyl</span> <span class="op">+</span> <span class="va">Engine</span><span class="op">:</span><span class="va">vs</span> <span class="op">~</span></span>
<span>                   <span class="va">N</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="va">`Horse Power`</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_hp</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_hp</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="va">`Weight`</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_wt</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_wt</span><span class="op">)</span>,</span>
<span>                 title <span class="op">=</span> <span class="st">"Motor Trend Car Road Tests"</span>,</span>
<span>                 subtitle <span class="op">=</span> <span class="st">"A table created with tablespan"</span>,</span>
<span>                 footnote <span class="op">=</span> <span class="st">"Data from the infamous mtcars data set."</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tbl</span>, use_hux <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Motor Trend Car Road Tests</span></span>
<span><span class="co">#&gt; A table created with tablespan</span></span>
<span><span class="co">#&gt;                                                         </span></span>
<span><span class="co">#&gt;  |                 |     Horse Power       Weight      |</span></span>
<span><span class="co">#&gt;  | Cylinder Engine | N   Mean        SD    Mean   SD   |</span></span>
<span><span class="co">#&gt;  | -------- ------ - --  ----------- ----- ------ ---- |</span></span>
<span><span class="co">#&gt;  | 4        0      | 1   91                2.14        |</span></span>
<span><span class="co">#&gt;  | 4        1      | 10  81.8        21.87 2.3    0.6  |</span></span>
<span><span class="co">#&gt;  | 6        0      | 3   131.67      37.53 2.76   0.13 |</span></span>
<span><span class="co">#&gt;  | ...      ...    | ... ...         ...   ...    ...  |</span></span>
<span><span class="co">#&gt; Data from the infamous mtcars data set.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tables-without-row-names">Tables without row names<a class="anchor" aria-label="anchor" href="#tables-without-row-names"></a>
</h3>
<p>Using <code>1</code> on the left hand side of the formula creates a table without row names. For example, <code>1 ~ (Horsepower = Mean:mean_hp + SD:sd_hp)</code> defines:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="fl">1</span> <span class="op">~</span> <span class="op">(</span><span class="va">Horsepower</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_hp</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_hp</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>use_hux <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      </span></span>
<span><span class="co">#&gt;  | Horsepower       |</span></span>
<span><span class="co">#&gt;  | Mean       SD    |</span></span>
<span><span class="co">#&gt;  | ---------- ----- |</span></span>
<span><span class="co">#&gt;  | 91               |</span></span>
<span><span class="co">#&gt;  | 81.8       21.87 |</span></span>
<span><span class="co">#&gt;  | 131.67     37.53 |</span></span>
<span><span class="co">#&gt;  | ...        ...   |</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="exporting-to-excel">Exporting to Excel<a class="anchor" aria-label="anchor" href="#exporting-to-excel"></a>
</h2>
<p>Tables created with <code>tablespan</code> can now be translated to xlsx tables with <a href="https://ycphs.github.io/openxlsx/" class="external-link"><code>openxlsx</code></a> using the <code>as_excel</code> function (alternatively, tables can also be exported to <code>huxtable</code> and then exported to <code>openxlsx</code>; see <code><a href="https://hughjonesd.github.io/huxtable/reference/as_Workbook.html" class="external-link">?huxtable::as_Workbook</a></code>):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># as_excel creates an openxlsx workbook</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_excel.html">as_excel</a></span><span class="op">(</span>tbl <span class="op">=</span> <span class="va">tbl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the workbook as an xlsx file:</span></span>
<span><span class="co"># openxlsx::saveWorkbook(wb,</span></span>
<span><span class="co">#                        file = "cars.xlsx", </span></span>
<span><span class="co">#                        overwrite = TRUE)</span></span></code></pre></div>
<p><img src="reference/figures/tablespan_example_cars.png"></p>
</div>
<div class="section level2">
<h2 id="exporting-to-html-pdf-png-latex-rtf-word-powerpoint-markdown-or-console">Exporting to HTML, PDF, PNG, LaTeX, RTF, Word, PowerPoint, Markdown, or Console<a class="anchor" aria-label="anchor" href="#exporting-to-html-pdf-png-latex-rtf-word-powerpoint-markdown-or-console"></a>
</h2>
<p>Tables created with <code>tablespan</code> can also be exported to a variety of other, more flexible table packages. <code>gt</code> which allows saving as HTML, LaTeX, or RTF file. To this end, we simply have to call <code>as_gt</code> on our table:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Translate to gt:</span></span>
<span><span class="va">gt_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_gt.html">as_gt</a></span><span class="op">(</span>tbl <span class="op">=</span> <span class="va">tbl</span><span class="op">)</span></span>
<span><span class="va">gt_tbl</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_gt_cars.png" alt="Standard table" width="50%"></p>

</div>
<div class="section level2">
<h2 id="styling">Styling<a class="anchor" aria-label="anchor" href="#styling"></a>
</h2>
<p><code>tablespan</code> allows adding styles to tables that are automatically exported to all exported tables (<code>gt</code>, <code>openxlsx</code>, <code>flextable</code>, and <code>huxtable</code>). The workflow is heavily inspired by <code>gt</code>.</p>
<p>All functions used to style <code>tablespan</code> tables start with <code>style_</code>:</p>
<ul>
<li>
<code>style_title</code>: Adapt the style of the title</li>
<li>
<code>style_subtitle</code>: Adapt the style of the subtitle</li>
<li>
<code>style_header</code>: Adapt the style of the header</li>
<li>
<code>style_header_cells</code>: Stlye the header cells in openxlsx. Used to create the borders around header cells (only relevant for openxlsx exports)</li>
<li>
<code>style_column</code>: Add styling to the body of the table</li>
<li>
<code>style_footnote</code>: Adapt the style of the footnotes</li>
<li>
<code>style_vline</code>: Adapt the style of the vertical lines in the table. Only relevant for openxlsx</li>
<li>
<code>style_hline</code>: Adapt the style of the horizontal lines in the table. Only relevant for openxlsx</li>
</ul>
<div class="section level3">
<h3 id="styling-the-title-and-subtitle">Styling the title and subtitle<a class="anchor" aria-label="anchor" href="#styling-the-title-and-subtitle"></a>
</h3>
<p>Use the <code>style_title</code> and <code>style_subtitle</code> options to style title and subtitle:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/style_title.html">style_title</a></span><span class="op">(</span>background_color <span class="op">=</span> <span class="st">"#000000"</span>,</span>
<span>              text_color <span class="op">=</span> <span class="st">"#ffffff"</span>,</span>
<span>              bold <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              italic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/style_subtitle.html">style_subtitle</a></span><span class="op">(</span>italic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/as_gt.html">as_gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_gt_cars_title.png" alt="Standard table" width="50%"></p>

<p>All of the styles applied in the following would also be exported to .xlsx files when using <code>as_excel</code> and saving the workbook with <code>openxlsx</code>.</p>
</div>
<div class="section level3">
<h3 id="styling-the-header">Styling the header<a class="anchor" aria-label="anchor" href="#styling-the-header"></a>
</h3>
<p>To adapt the header, use <code>style_header</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/style_header.html">style_header</a></span><span class="op">(</span>background_color <span class="op">=</span> <span class="st">"#000000"</span>,</span>
<span>               text_color <span class="op">=</span> <span class="st">"#ffffff"</span>,</span>
<span>               bold <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               italic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/as_gt.html">as_gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_gt_cars_header.png" alt="Standard table" width="50%"></p>

</div>
<div class="section level3">
<h3 id="styling-the-body">Styling the body<a class="anchor" aria-label="anchor" href="#styling-the-body"></a>
</h3>
<p>The body is adapted with <code>style_column</code>. This function also allows styling only specific cells in the body or styling multiple columns at once. Columns are selected with tidy expressions. Please note that you will have to reference the columns with their respective names in the raw data set, not the names shown in the spanner:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/style_column.html">style_column</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"mean_"</span><span class="op">)</span>,</span>
<span>    rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>    background_color <span class="op">=</span> <span class="st">"#000000"</span>,</span>
<span>    text_color <span class="op">=</span> <span class="st">"#ffffff"</span>,</span>
<span>    bold <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    italic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/as_gt.html">as_gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_gt_cars_column.png" alt="Standard table" width="50%"></p>

</div>
<div class="section level3">
<h3 id="styling-the-footnote">Styling the footnote<a class="anchor" aria-label="anchor" href="#styling-the-footnote"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/style_footnote.html">style_footnote</a></span><span class="op">(</span></span>
<span>    background_color <span class="op">=</span> <span class="st">"#000000"</span>,</span>
<span>    text_color <span class="op">=</span> <span class="st">"#ffffff"</span>,</span>
<span>    bold <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    italic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/as_gt.html">as_gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_gt_cars_footnote.png" alt="Standard table" width="50%"></p>

</div>
<div class="section level3">
<h3 id="custom-styles">Custom styles<a class="anchor" aria-label="anchor" href="#custom-styles"></a>
</h3>
<p>The current interface only exports a small amount of the styles available in <code>gt</code> and <code>openxlsx</code>. However, you can also provide custom styles:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/style_column.html">style_column</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>,</span>
<span>    <span class="co"># custom style for the gt table export:</span></span>
<span>    gt_style <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>decorate <span class="op">=</span> <span class="st">"underline"</span><span class="op">)</span>,</span>
<span>    <span class="co"># custom style for the excel table export:</span></span>
<span>    openxlsx_style <span class="op">=</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/createStyle.html" class="external-link">createStyle</a></span><span class="op">(</span>textDecoration <span class="op">=</span> <span class="st">"underline"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/as_gt.html">as_gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_gt_cars_costum.png" alt="Standard table" width="50%"></p>

</div>
</div>
<div class="section level2">
<h2 id="formatting">Formatting<a class="anchor" aria-label="anchor" href="#formatting"></a>
</h2>
<p>In addition to applying specific styles to the table, you can also adapt the number formatting. The current setup is slightly more complicated because unifying all of the possible styles supported by <code>gt</code> and <code>openxlsx</code> is challenging.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/format_column.html">format_column</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>,</span>
<span>        rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>        <span class="co"># For great tables, we need a function that </span></span>
<span>        <span class="co"># takes in the table, columns, and rows and then</span></span>
<span>        <span class="co"># applies the style</span></span>
<span>        format_gt <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">columns</span>, <span class="va">rows</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span><span class="va">x</span>, columns <span class="op">=</span> <span class="va">columns</span>, rows <span class="op">=</span> <span class="va">rows</span>, decimals <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>        <span class="co"># For openxlsx, we have to provide the style that will be passed</span></span>
<span>        <span class="co"># to numFmt in openxlsx::createStyle</span></span>
<span>        format_openxlsx <span class="op">=</span> <span class="st">"0.0000"</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/as_gt.html">as_gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_styling.png" alt="Standard table" width="50%"></p>

</div>
<div class="section level2">
<h2 id="adapting-great-tables">Adapting Great Tables<a class="anchor" aria-label="anchor" href="#adapting-great-tables"></a>
</h2>
<p>The <code>gt</code> package provides a wide range of functions to adapt the style of the table created with <code>as_gt</code>. For instance, <code>opt_stylize</code> adds a pre-defined style to the entire table:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/opt_stylize.html" class="external-link">opt_stylize</a></span><span class="op">(</span>style <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                  color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_gt_cars_styled.png" alt="Styled table" width="50%"></p>

<p>When adapting the <code>gt</code> object, there is an important detail to keep in mind: To ensure that each table spanner has a unique ID, <code>tablespan</code> will create IDs that differ from the text shown in the spanner. To demonstrate this, Let’s assume that we want to add a spanner above <code>Horse Power</code> and <code>Weight</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"New Spanner"</span>, </span>
<span>                  spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Horse Power"</span>, <span class="st">"Weight"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `gt::tab_spanner()`:</span></span>
<span><span class="co">#&gt; ! One or more spanner ID(s) supplied in `spanners` (Horse Power and</span></span>
<span><span class="co">#&gt;   Weight), for the new spanner with the ID `New Spanner` doesn't belong to any</span></span>
<span><span class="co">#&gt;   existing spanners.</span></span></code></pre></div>
<p>This will throw an error because the spanner IDs are different from the spanner labels. To get the spanner IDs, use <code><a href="https://gt.rstudio.com/reference/tab_info.html" class="external-link">gt::tab_info()</a></code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_info.html" class="external-link">tab_info</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_tab_info.png" alt="Table spanner IDs" width="50%"></p>

<p>The IDs for the spanners can be found at the very bottom. To add another spanner above <code>Horse Power</code> and <code>Weight</code>, we have to use these IDs:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"New Spanner"</span>, </span>
<span>                  spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"__BASE_LEVEL__Horse Power"</span>, </span>
<span>                               <span class="st">"__BASE_LEVEL__Weight"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p align="center">
</p>
<p><img src="reference/figures/tablespan_example_new_spanner.png" alt="Table with additional spanner" width="50%"></p>

</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>gt: Iannone R, Cheng J, Schloerke B, Hughes E, Lauer A, Seo J, Brevoort K, Roy O (2024). gt: Easily Create Presentation-Ready Display Tables. R package version 0.11.1.9000, <a href="https://github.com/rstudio/gt" class="external-link uri">https://github.com/rstudio/gt</a>, <a href="https://gt.rstudio.com" class="external-link uri">https://gt.rstudio.com</a>.</li>
<li>openxlsx: Schauberger P, Walker A (2023). <em>openxlsx: Read, Write and Edit xlsx Files</em>. R package version 4.2.5.2, <a href="https://ycphs.github.io/openxlsx/" class="external-link uri">https://ycphs.github.io/openxlsx/</a>.</li>
<li>flextable: Gohel D, Skintzos P (2025). <em>flextable: Functions for Tabular Reporting</em>. R package version 0.9.10, <a href="https://CRAN.R-project.org/package=flextable" class="external-link uri">https://CRAN.R-project.org/package=flextable</a>
</li>
<li>huxtable: Hugh-Jones D (2025). <em>huxtable: Easily Create and Style Tables for LaTeX, HTML and Other Formats</em>. R package version 5.8.0, <a href="https://CRAN.R-project.org/package=huxtable" class="external-link uri">https://CRAN.R-project.org/package=huxtable</a>
</li>
<li>tables: Murdoch D (2024). tables: Formula-Driven Table Generation. R package version 0.9.31, <a href="https://dmurdoch.github.io/tables/" class="external-link uri">https://dmurdoch.github.io/tables/</a>.</li>
</ul>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=tablespan" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/jhorzek/tablespan/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/jhorzek/tablespan/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tablespan</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jannik H. Orzek <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-3123-2248" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=tablespan" class="external-link"><img src="https://www.r-pkg.org/badges/version/tablespan" alt="CRAN status"></a></li>
<li><a href="https://cranlogs.r-pkg.org/badges/grand-total/tablespan" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/tablespan" alt="Total Downloads"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jannik H. Orzek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
