<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create satisficing Excel, HTML, LaTeX, and RTF tables using a simple formula • tablespan</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Create satisficing Excel, HTML, LaTeX, and RTF tables using a simple formula">
<meta name="description" content='tablespan provides a "good enough" approach to creating Excel, HTML, LaTeX, and RTF tables in R by leveraging openxlsx and gt.'>
<meta property="og:description" content='tablespan provides a "good enough" approach to creating Excel, HTML, LaTeX, and RTF tables in R by leveraging openxlsx and gt.'>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tablespan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jhorzek/tablespan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tablespan">tablespan<a class="anchor" aria-label="anchor" href="#tablespan"></a>
</h1></div>
<blockquote>
<p>Create satisficing tables in R the formula way.</p>
</blockquote>
<p>The objective of <code>tablespan</code> is to provide a “good enough” approach to creating tables by leveraging R’s formulas.</p>
<p><code>tablespan</code> builds on the awesome packages <a href="https://ycphs.github.io/openxlsx/" class="external-link"><code>openxlsx</code></a> and <a href="https://gt.rstudio.com/" class="external-link"><code>gt</code></a>, which allows tables created with <code>tablespan</code> to be exported to the following formats:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Excel</strong> (using <a href="https://ycphs.github.io/openxlsx/" class="external-link"><code>openxlsx</code></a>)</li>
<li>
<strong>HTML</strong> (using <a href="https://gt.rstudio.com/" class="external-link"><code>gt</code></a>)</li>
<li>
<strong>LaTeX</strong> (using <a href="https://gt.rstudio.com/" class="external-link"><code>gt</code></a>)</li>
<li>
<strong>RTF</strong> (using <a href="https://gt.rstudio.com/" class="external-link"><code>gt</code></a>)</li>
</ol>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><code>tablespan</code> is not yet available from CRAN. To install from GitHub, run the following lines:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"jhorzek/tablespan"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>R has a large set of great packages that allow you to create and export tables that look exactly like you envisioned. However, sometimes you may just need a good-enough table that is easy to create and share with others. This is where <code>tablespan</code> can be of help.</p>
<p>Let’s assume that we want to share the following table:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summarized_table</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">vs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            mean_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            sd_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            mean_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span>,</span>
<span>            sd_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'cyl'. You can override using the `.groups`</span></span>
<span><span class="co">#&gt; argument.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summarized_table</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 7</span></span>
<span><span class="co">#&gt; # Groups:   cyl [3]</span></span>
<span><span class="co">#&gt;     cyl    vs     N mean_hp sd_hp mean_wt  sd_wt</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     4     0     1    91   NA       2.14 NA    </span></span>
<span><span class="co">#&gt; 2     4     1    10    81.8 21.9     2.30  0.598</span></span>
<span><span class="co">#&gt; 3     6     0     3   132.  37.5     2.76  0.128</span></span>
<span><span class="co">#&gt; 4     6     1     4   115.   9.18    3.39  0.116</span></span>
<span><span class="co">#&gt; 5     8     0    14   209.  51.0     4.00  0.759</span></span></code></pre></div>
<p>We don’t want to share the table as is - the variable names are all a bit technical and the table could need some spanners summarizing columns. So, we want to share a table that looks something like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">|</span>                   <span class="er">|</span> Horse Power <span class="sc">|</span>   Weight  <span class="sc">|</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="er">|</span> Cylinder <span class="sc">|</span> Engine <span class="sc">|</span> Mean  <span class="sc">|</span>  SD <span class="sc">|</span> Mean <span class="sc">|</span> SD <span class="sc">|</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="er">|</span> <span class="sc">--------</span> <span class="er">|</span> <span class="sc">------</span> <span class="er">|</span> <span class="sc">-----</span> <span class="er">|</span> <span class="sc">---</span> <span class="er">|</span> <span class="sc">----</span> <span class="er">|</span> <span class="sc">--</span> <span class="er">|</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="er">|</span>                   <span class="er">|</span>                         <span class="er">|</span></span></code></pre></div>
<p><code>tablespan</code> allows us to create this table with a single formula.</p>
<div class="section level3">
<h3 id="creating-a-basic-table">Creating a Basic Table<a class="anchor" aria-label="anchor" href="#creating-a-basic-table"></a>
</h3>
<p>In <code>tablespan</code>, the table headers are defined with a formula. For example, <code>cyl ~ mean_hp + sd_hp</code> defines a table with <code>cyl</code> as the row names and <code>mean_hp</code> and <code>sd_hp</code> as columns:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhorzek.github.io/tablespan/">tablespan</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="va">cyl</span> <span class="op">~</span> <span class="va">mean_hp</span> <span class="op">+</span> <span class="va">sd_hp</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         </span></span>
<span><span class="co">#&gt;  | cyl | mean_hp sd_hp |</span></span>
<span><span class="co">#&gt;  | --- - ------- ----- |</span></span>
<span><span class="co">#&gt;  | 4   | 91            |</span></span>
<span><span class="co">#&gt;  | 4   | 81.8    21.87 |</span></span>
<span><span class="co">#&gt;  | 6   | 131.67  37.53 |</span></span>
<span><span class="co">#&gt;  | ... | ...     ...   |</span></span></code></pre></div>
<p>Note that the row names (<code>cyl</code>) are in a separate block to the left.</p>
</div>
<div class="section level3">
<h3 id="adding-spanners">Adding Spanners<a class="anchor" aria-label="anchor" href="#adding-spanners"></a>
</h3>
<p>Spanners are defined using braces and spanner names. For example, the following defines a spanner for <code>mean_hp</code> and <code>sd_hp</code> with the name <code>Horsepower</code>: <code>cyl ~ (Horsepower = mean_hp + sd_hp)</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="va">cyl</span> <span class="op">~</span> <span class="op">(</span><span class="va">Horsepower</span> <span class="op">=</span> <span class="va">mean_hp</span> <span class="op">+</span> <span class="va">sd_hp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt;  |     | Horsepower       |</span></span>
<span><span class="co">#&gt;  | cyl | mean_hp    sd_hp |</span></span>
<span><span class="co">#&gt;  | --- - ---------- ----- |</span></span>
<span><span class="co">#&gt;  | 4   | 91               |</span></span>
<span><span class="co">#&gt;  | 4   | 81.8       21.87 |</span></span>
<span><span class="co">#&gt;  | 6   | 131.67     37.53 |</span></span>
<span><span class="co">#&gt;  | ... | ...        ...   |</span></span></code></pre></div>
<p>Spanners can also be nested:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="va">cyl</span> <span class="op">~</span> <span class="op">(</span><span class="va">Horsepower</span> <span class="op">=</span> <span class="op">(</span><span class="va">Mean</span> <span class="op">=</span> <span class="va">mean_hp</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">SD</span>  <span class="op">=</span> <span class="va">sd_hp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt;  |     | Horsepower       |</span></span>
<span><span class="co">#&gt;  |     | Mean       SD    |</span></span>
<span><span class="co">#&gt;  | cyl | mean_hp    sd_hp |</span></span>
<span><span class="co">#&gt;  | --- - ---------- ----- |</span></span>
<span><span class="co">#&gt;  | 4   | 91               |</span></span>
<span><span class="co">#&gt;  | 4   | 81.8       21.87 |</span></span>
<span><span class="co">#&gt;  | 6   | 131.67     37.53 |</span></span>
<span><span class="co">#&gt;  | ... | ...        ...   |</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="renaming-columns">Renaming Columns<a class="anchor" aria-label="anchor" href="#renaming-columns"></a>
</h3>
<p>Variable names in an R <code>data.frame</code> are often very technical (e.g., <code>mean_hp</code> and <code>sd_hp</code>). When sharing the table, we may want to replace those names. In the example above, we may want to replace <code>mean_hp</code> and <code>sd_hp</code> with “Mean” and “SD”. In <code>tablespan</code> renaming variables is achieved with <code>new_name:old_name</code>. For example, <code>cyl ~ (Horsepower = Mean:mean_hp + SD:sd_hp)</code> renames <code>mean_hp</code> to <code>Mean</code> and <code>sd_hp</code> to <code>SD</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="va">cyl</span> <span class="op">~</span> <span class="op">(</span><span class="va">Horsepower</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_hp</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_hp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                            </span></span>
<span><span class="co">#&gt;  |     | Horsepower       |</span></span>
<span><span class="co">#&gt;  | cyl | Mean       SD    |</span></span>
<span><span class="co">#&gt;  | --- - ---------- ----- |</span></span>
<span><span class="co">#&gt;  | 4   | 91               |</span></span>
<span><span class="co">#&gt;  | 4   | 81.8       21.87 |</span></span>
<span><span class="co">#&gt;  | 6   | 131.67     37.53 |</span></span>
<span><span class="co">#&gt;  | ... | ...        ...   |</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-the-full-table">Creating the Full Table<a class="anchor" aria-label="anchor" href="#creating-the-full-table"></a>
</h3>
<p>The combination of row names, spanners, and renaming of variables allows creating the full table:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhorzek.github.io/tablespan/">tablespan</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summarized_table</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">vs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            mean_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            sd_hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>,</span>
<span>            mean_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span>,</span>
<span>            sd_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'cyl'. You can override using the `.groups`</span></span>
<span><span class="co">#&gt; argument.</span></span>
<span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>                 formula <span class="op">=</span> <span class="va">Cylinder</span><span class="op">:</span><span class="va">cyl</span> <span class="op">+</span> <span class="va">Engine</span><span class="op">:</span><span class="va">vs</span> <span class="op">~</span></span>
<span>                   <span class="va">N</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="va">`Horse Power`</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_hp</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_hp</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="va">`Weight`</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_wt</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_wt</span><span class="op">)</span>,</span>
<span>                 title <span class="op">=</span> <span class="st">"Motor Trend Car Road Tests"</span>,</span>
<span>                 subtitle <span class="op">=</span> <span class="st">"A table created with tablespan"</span>,</span>
<span>                 footnote <span class="op">=</span> <span class="st">"Data from the infamous mtcars data set."</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span>
<span><span class="co">#&gt; Motor Trend Car Road Tests</span></span>
<span><span class="co">#&gt; A table created with tablespan</span></span>
<span><span class="co">#&gt;                                                         </span></span>
<span><span class="co">#&gt;  |                 |     Horse Power       Weight      |</span></span>
<span><span class="co">#&gt;  | Cylinder Engine | N   Mean        SD    Mean   SD   |</span></span>
<span><span class="co">#&gt;  | -------- ------ - --  ----------- ----- ------ ---- |</span></span>
<span><span class="co">#&gt;  | 4        0      | 1   91                2.14        |</span></span>
<span><span class="co">#&gt;  | 4        1      | 10  81.8        21.87 2.3    0.6  |</span></span>
<span><span class="co">#&gt;  | 6        0      | 3   131.67      37.53 2.76   0.13 |</span></span>
<span><span class="co">#&gt;  | ...      ...    | ... ...         ...   ...    ...  |</span></span>
<span><span class="co">#&gt; Data from the infamous mtcars data set.</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="exporting-to-excel">Exporting to Excel<a class="anchor" aria-label="anchor" href="#exporting-to-excel"></a>
</h2>
<p>Tables created with <code>tablespan</code> can now be translated to xlsx tables with <a href="https://ycphs.github.io/openxlsx/" class="external-link"><code>openxlsx</code></a> using the <code>as_excel</code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># as_excel creates an openxlsx workbook</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_excel.html">as_excel</a></span><span class="op">(</span>tbl <span class="op">=</span> <span class="va">tbl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the workbook as an xlsx file:</span></span>
<span><span class="co"># openxlsx::saveWorkbook(wb,</span></span>
<span><span class="co">#                        file = "cars.xlsx", </span></span>
<span><span class="co">#                        overwrite = TRUE)</span></span></code></pre></div>
<p><img src="reference/figures/tablespan_example_cars.png"></p>
<div class="section level3">
<h3 id="styling">Styling<a class="anchor" aria-label="anchor" href="#styling"></a>
</h3>
<p>While <code>tablespan</code> provides limited styling options, some elements can be adjusted. For example, we may want to print some elements in bold or format numbers differently. In <code>tablespan</code>, styling happens when translating the table to an <code>openxlsx</code> workbook with <code>as_excel</code>. To this end, <code>tablespan</code> provides a <code>styles</code> argument.</p>
<div class="section level4">
<h4 id="formatting-cells">Formatting Cells<a class="anchor" aria-label="anchor" href="#formatting-cells"></a>
</h4>
<p>Let’s assume we want all <code>mean_hp</code> values with a value <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">\geq 100</annotation></semantics></math> to be printed in bold. To this end, we first create a new style object using <code>openxlsx</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bold</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/createStyle.html" class="external-link">createStyle</a></span><span class="op">(</span>textDecoration <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span></code></pre></div>
<p>Next, we create a cell style with <code>tablespan</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hp_ge_100</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cell_style.html">cell_style</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">summarized_table</span><span class="op">$</span><span class="va">mean_hp</span> <span class="op">&gt;=</span> <span class="fl">100</span><span class="op">)</span>, </span>
<span>                        colnames <span class="op">=</span> <span class="st">"mean_hp"</span>, </span>
<span>                        style <span class="op">=</span> <span class="va">bold</span>,</span>
<span>                        gridExpand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Note that we specify the indices of the rows that we want to be in bold and the column name of the item.</p>
<p>Finally, we pass this style as part of a list to <code>as_excel</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># as_excel creates an openxlsx workbook</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_excel.html">as_excel</a></span><span class="op">(</span>tbl <span class="op">=</span> <span class="va">tbl</span>, </span>
<span>               styles <span class="op">=</span> <span class="fu"><a href="reference/tbl_styles.html">tbl_styles</a></span><span class="op">(</span>cell_styles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">hp_ge_100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the workbook as an xlsx file:</span></span>
<span><span class="co"># openxlsx::saveWorkbook(wb,</span></span>
<span><span class="co">#                        file = "cars.xlsx", </span></span>
<span><span class="co">#                        overwrite = TRUE)</span></span></code></pre></div>
<p><img src="reference/figures/tablespan_example_cars_styled.png"></p>
</div>
<div class="section level4">
<h4 id="formatting-data-types">Formatting Data Types<a class="anchor" aria-label="anchor" href="#formatting-data-types"></a>
</h4>
<p><code>tablespan</code> also allows formatting specific data types. Let’s assume that we want to round all doubles to 3 instead of the default 2 digits. To this end, we use the <code>create_data_styles</code> function, where we specify (1) a function that checks for the data type we want to style (here <code>is.double</code>) and (2) a style for all columns that match that style:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">double_style</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_data_styles.html">create_data_styles</a></span><span class="op">(</span>double <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>test <span class="op">=</span> <span class="va">is.double</span>, </span>
<span>                                                 style <span class="op">=</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/createStyle.html" class="external-link">createStyle</a></span><span class="op">(</span>numFmt <span class="op">=</span> <span class="st">"0.000"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_excel.html">as_excel</a></span><span class="op">(</span>tbl <span class="op">=</span> <span class="va">tbl</span>, styles <span class="op">=</span> <span class="fu"><a href="reference/tbl_styles.html">tbl_styles</a></span><span class="op">(</span>data_styles <span class="op">=</span> <span class="va">double_style</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the workbook as an xlsx file:</span></span>
<span><span class="co"># openxlsx::saveWorkbook(wb,</span></span>
<span><span class="co">#                        file = "cars.xlsx", </span></span>
<span><span class="co">#                        overwrite = TRUE)</span></span></code></pre></div>
<p><img src="reference/figures/tablespan_example_cars_styled_data.png"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="exporting-to-html-latex-and-rtf">Exporting to HTML, LaTeX, and RTF<a class="anchor" aria-label="anchor" href="#exporting-to-html-latex-and-rtf"></a>
</h2>
<p>Tables created with <code>tablespan</code> can also be exported to <code>gt</code> which allows saving as HTML, LaTeX, or RTF file. To this end, we simply have to call <code>as_gt</code> on our table:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Translate to gt:</span></span>
<span><span class="va">gt_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_gt.html">as_gt</a></span><span class="op">(</span>tbl <span class="op">=</span> <span class="va">tbl</span><span class="op">)</span></span>
<span><span class="va">gt_tbl</span></span></code></pre></div>
<p align="center">
<img src="reference/figures/tablespan_example_gt_cars.png" alt="Standard table" width="50%"></p>
<div class="section level3">
<h3 id="styling-great-tables">Styling Great Tables<a class="anchor" aria-label="anchor" href="#styling-great-tables"></a>
</h3>
<p>The <code>gt</code> package provides a wide range of functions to adapt the style of the table created with <code>as_gt</code>. For instance, <code>opt_stylize</code> adds a pre-defined style to the entire table:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/opt_stylize.html" class="external-link">opt_stylize</a></span><span class="op">(</span>style <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                  color <span class="op">=</span> <span class="st">'gray'</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="reference/figures/tablespan_example_gt_cars_styled.png" alt="Styled table" width="50%"></p>
<p>When adapting the <code>gt</code> object, there is an important detail to keep in mind: To ensure that each table spanner has a unique ID, <code>tablespan</code> will create IDs that differ from the text shown in the spanner. To demonstrate this, Let’s assume that we want to add a spanner above <code>Horse Power</code> and <code>Weight</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"New Spanner"</span>, </span>
<span>                  spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Horse Power"</span>, <span class="st">"Weight"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `gt::tab_spanner()`:</span></span>
<span><span class="co">#&gt; ! One or more spanner ID(s) supplied in `spanners` (Horse Power and</span></span>
<span><span class="co">#&gt;   Weight), for the new spanner with the ID `New Spanner` doesn't belong to any</span></span>
<span><span class="co">#&gt;   existing spanners.</span></span></code></pre></div>
<p>This will throw an error because the spanner IDs are different from the spanner labels. To get the spanner IDs, use <code><a href="https://gt.rstudio.com/reference/tab_info.html" class="external-link">gt::tab_info()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_info.html" class="external-link">tab_info</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="cctlqodhdh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#cctlqodhdh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
&#10;#cctlqodhdh thead, #cctlqodhdh tbody, #cctlqodhdh tfoot, #cctlqodhdh tr, #cctlqodhdh td, #cctlqodhdh th {
  border-style: none;
}
&#10;#cctlqodhdh p {
  margin: 0;
  padding: 0;
}
&#10;#cctlqodhdh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 800px;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #F7F7F7;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}
&#10;#cctlqodhdh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}
&#10;#cctlqodhdh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}
&#10;#cctlqodhdh .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}
&#10;#cctlqodhdh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}
&#10;#cctlqodhdh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}
&#10;#cctlqodhdh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}
&#10;#cctlqodhdh .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}
&#10;#cctlqodhdh .gt_spanner_row {
  border-bottom-style: hidden;
}
&#10;#cctlqodhdh .gt_group_heading {
  padding-top: 12px;
  padding-bottom: 12px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}
&#10;#cctlqodhdh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}
&#10;#cctlqodhdh .gt_from_md > :first-child {
  margin-top: 0;
}
&#10;#cctlqodhdh .gt_from_md > :last-child {
  margin-bottom: 0;
}
&#10;#cctlqodhdh .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F7F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}
&#10;#cctlqodhdh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#cctlqodhdh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}
&#10;#cctlqodhdh .gt_row_group_first td {
  border-top-width: 1px;
}
&#10;#cctlqodhdh .gt_row_group_first th {
  border-top-width: 1px;
}
&#10;#cctlqodhdh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#cctlqodhdh .gt_first_summary_row {
  border-top-style: none;
  border-top-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_first_summary_row.thick {
  border-top-width: 2px;
}
&#10;#cctlqodhdh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#cctlqodhdh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: none;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: none;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}
&#10;#cctlqodhdh .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#cctlqodhdh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#cctlqodhdh .gt_sourcenote {
  font-size: 10px;
  padding-top: 6px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#cctlqodhdh .gt_left {
  text-align: left;
}
&#10;#cctlqodhdh .gt_center {
  text-align: center;
}
&#10;#cctlqodhdh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}
&#10;#cctlqodhdh .gt_font_normal {
  font-weight: normal;
}
&#10;#cctlqodhdh .gt_font_bold {
  font-weight: bold;
}
&#10;#cctlqodhdh .gt_font_italic {
  font-style: italic;
}
&#10;#cctlqodhdh .gt_super {
  font-size: 65%;
}
&#10;#cctlqodhdh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}
&#10;#cctlqodhdh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}
&#10;#cctlqodhdh .gt_indent_1 {
  text-indent: 5px;
}
&#10;#cctlqodhdh .gt_indent_2 {
  text-indent: 10px;
}
&#10;#cctlqodhdh .gt_indent_3 {
  text-indent: 15px;
}
&#10;#cctlqodhdh .gt_indent_4 {
  text-indent: 20px;
}
&#10;#cctlqodhdh .gt_indent_5 {
  text-indent: 25px;
}
&#10;#cctlqodhdh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}
&#10;#cctlqodhdh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" style="table-layout:fixed;width:800px;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width:250px;">
<col style="width:50px;">
<col style="width:280px;">
</colgroup>
<thead>
<tr class="gt_heading">
<td colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>
<span class="gt_from_md">Information on ID and Label Values</span>
</td>
</tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub">
ID
</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="i">
<span class="gt_from_md"><em>Idx</em><br><em>Lvl</em></span>
</th>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label">
Label
</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Columns">
Columns
</th>
</tr>
<tr class="gt_row_group_first">
<th id="stub_1_1" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
cyl
</th>
<td headers="Columns stub_1_1 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
1
</td>
<td headers="Columns stub_1_1 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
Cylinder
</td>
</tr>
<tr>
<th id="stub_1_2" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
vs
</th>
<td headers="Columns stub_1_2 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
2
</td>
<td headers="Columns stub_1_2 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
Engine
</td>
</tr>
<tr>
<th id="stub_1_3" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
N
</th>
<td headers="Columns stub_1_3 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
3
</td>
<td headers="Columns stub_1_3 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
N
</td>
</tr>
<tr>
<th id="stub_1_4" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
mean_hp
</th>
<td headers="Columns stub_1_4 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
4
</td>
<td headers="Columns stub_1_4 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
Mean
</td>
</tr>
<tr>
<th id="stub_1_5" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
sd_hp
</th>
<td headers="Columns stub_1_5 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
5
</td>
<td headers="Columns stub_1_5 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
SD
</td>
</tr>
<tr>
<th id="stub_1_6" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
mean_wt
</th>
<td headers="Columns stub_1_6 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
6
</td>
<td headers="Columns stub_1_6 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
Mean
</td>
</tr>
<tr>
<th id="stub_1_7" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
sd_wt
</th>
<td headers="Columns stub_1_7 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
7
</td>
<td headers="Columns stub_1_7 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
SD
</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Rows">
Rows
</th>
</tr>
<tr class="gt_row_group_first">
<th id="stub_1_8" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
&lt;&lt; Index values 1 to 5 &gt;&gt;
</th>
<td headers="Rows stub_1_8 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
<br>
</td>
<td headers="Rows stub_1_8 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
<br>
</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="3" class="gt_group_heading" scope="colgroup" id="Spanners">
Spanners
</th>
</tr>
<tr class="gt_row_group_first">
<th id="stub_1_9" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
__BASE_LEVEL__Horse Power
</th>
<td headers="Spanners stub_1_9 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
1
</td>
<td headers="Spanners stub_1_9 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
Horse Power
</td>
</tr>
<tr>
<th id="stub_1_10" scope="row" class="gt_row gt_left gt_stub" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
__BASE_LEVEL__Weight
</th>
<td headers="Spanners stub_1_10 i" class="gt_row gt_right" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
1
</td>
<td headers="Spanners stub_1_10 label" class="gt_row gt_left" style="font-family: 'IBM Plex Mono'; font-size: 14px;">
Weight
</td>
</tr>
</tbody>
</table>
</div>
<p>The IDs for the spanners can be found at the very bottom. To add another spanner above <code>Horse Power</code> and <code>Weight</code>, we have to use these IDs:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt_tbl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"New Spanner"</span>, </span>
<span>                  spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"__BASE_LEVEL__Horse Power"</span>, </span>
<span>                               <span class="st">"__BASE_LEVEL__Weight"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="tables-without-row-names">Tables without row names<a class="anchor" aria-label="anchor" href="#tables-without-row-names"></a>
</h2>
<p>Using <code>1</code> on the left hand side of the formula creates a table without row names. For example, <code>1 ~ (Horsepower = Mean:mean_hp + SD:sd_hp)</code> defines</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/tablespan.html">tablespan</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">summarized_table</span>,</span>
<span>          formula <span class="op">=</span> <span class="fl">1</span> <span class="op">~</span> <span class="op">(</span><span class="va">Horsepower</span> <span class="op">=</span> <span class="va">Mean</span><span class="op">:</span><span class="va">mean_hp</span> <span class="op">+</span> <span class="va">SD</span><span class="op">:</span><span class="va">sd_hp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      </span></span>
<span><span class="co">#&gt;  | Horsepower       |</span></span>
<span><span class="co">#&gt;  | Mean       SD    |</span></span>
<span><span class="co">#&gt;  | ---------- ----- |</span></span>
<span><span class="co">#&gt;  | 91               |</span></span>
<span><span class="co">#&gt;  | 81.8       21.87 |</span></span>
<span><span class="co">#&gt;  | 131.67     37.53 |</span></span>
<span><span class="co">#&gt;  | ...        ...   |</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>gt: Iannone R, Cheng J, Schloerke B, Hughes E, Lauer A, Seo J, Brevoort K, Roy O (2024). gt: Easily Create Presentation-Ready Display Tables. R package version 0.11.1.9000, <a href="https://github.com/rstudio/gt" class="external-link uri">https://github.com/rstudio/gt</a>, <a href="https://gt.rstudio.com" class="external-link uri">https://gt.rstudio.com</a>.</li>
<li>expss: Gregory D et al. (2024). expss: Tables with Labels in R. R package version 0.9.31, <a href="https://gdemin.github.io/expss/" class="external-link uri">https://gdemin.github.io/expss/</a>.</li>
<li>tables: Murdoch D (2024). tables: Formula-Driven Table Generation. R package version 0.9.31, <a href="https://dmurdoch.github.io/tables/" class="external-link uri">https://dmurdoch.github.io/tables/</a>.</li>
<li>openxlsx: Schauberger P, Walker A (2023). <em>openxlsx: Read, Write and Edit xlsx Files</em>. R package version 4.2.5.2, <a href="https://CRAN.R-project.org/package=openxlsx" class="external-link uri">https://CRAN.R-project.org/package=openxlsx</a>.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/jhorzek/tablespan/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/jhorzek/tablespan/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tablespan</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jannik H. Orzek <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jannik H. Orzek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
